<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Trivia Game</title>
    <link rel="stylesheet" href="./assets/css/reset.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!-- game font -->

    <!-- link jquery -->
    <script src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./assets/css/style.css">
</head>
<!-- game content -->
<body>
    <div class="container">
        <div class="row">
            <button id="start" type="button" class="btn btn-primary">start</button>
            <!-- <div id="game-timer"></div> -->
            <div id="content"></div>
        </div>
    </div>
    <!-- game Logic -->
<script>
var game = {
    // array of game content
    array: [
        {
            question: 'Which pokemon does Pikachu evolve into?',
            option: ['mewtwo', 'pichu', 'raichu', 'pachinko'],
            answer: 'raichu',
            img: 'https://i.imgur.com/m6kX7LO.gif'
        },
        {
            question: 'What\'s the most effective Poke Ball in the game',
            option: ['poke ball', 'ultra ball', 'a pikachu', 'master ball'],
            answer: 'master ball'
        },
        {
            question: 'Which was the first gym leader that beated Ash?',
            option: ['brock', 'misty', 'giovanni', 'erika'],
            answer: 'brock'
        },
        {
            question: 'Which was the first pokemon that was released from Ash?',
            option: ['pidgeot', 'buterfree', 'pikachu', 'lapras'],
            answer: 'buterfree'
        },
        {
            question: 'How many Gym Badges must a trainer collect before challenging the Elite Four?',
            option: ['4', '6', '8', '9'],
            answer: '8'
        },
        {
            question: 'What was the first pokemon ever created?', 
            option: ['bulbasaur', 'charmander', 'rhydon', 'pikachu'], 
            answer: 'rhydon'
        },
        {
            question: 'Which pokemon has the same cry as Charizard in games?',
            option: ['mewtwo', 'rhyhorn', 'dragonite', 'lugia'],
            answer: 'rhyhorn'
        },
        {
            question: 'Which pokemon is the longest one to hatch from an egg?',
            option: ['dratini', 'onix', 'pikachu', 'venomoth'],
            answer: 'onix'
        },
        {
            question: 'Which is the lightest pokemon?',
            option: ['metapod', 'pikachu', 'ghastly', 'caterpie'],
            answer: 'ghastly'
        },
        {
            question: 'What food do Kinglers mainly eat?',
            option: ['pikachu', 'krabby', 'shellder', 'magikarp'],
            answer: 'shellder'
        }
    ],
    // correct: 0,
    // incorrect: 0,
    // round: false,
    gameOver: function() {
        clearInterval(clock);
        $('#content').empty();
        $('#content').append('GAME OVER');
        $('#content').append(`<div> Correct: ${correct}`);
        $('#content').append(`<div> Incorrect: ${incorrect}`);
        $('#content').append('<div> Press start to try again!');
        $('#start').show();
        correct = 0;
        incorrect = 0;
        round = false;
    },
    // checks if button press is correct
    check: function() {
        buttonVal = $(this).attr('value');

        if (buttonVal === triviaAnswer) {
            correct++;
            console.log(`Correct: ${correct}`);
            isCorrect = true;
        } else {
            incorrect++;
            console.log(`Incorrect: ${incorrect}`);
            isCorrect = false;
        }
        clearInterval(clock);
        game.nextPage(); // comment out to pause the game
    },
    // show page after player win or lose
    nextPage: function() {
        // delare that round is not running; set interval to 3; clear content DOM
        round = false;
        count = 3;
        $('#content').empty();

        // check if answer is correct
        if (isCorrect) {
            $('#content').append(`<img src="https://i.imgur.com/m6kX7LO.gif" alt="Win Image">`);
        } else {
            $('#content').append(`<img src="https://media1.tenor.com/images/84c4e8c1a24b84bece745d2dcd2a5aa8/tenor.gif?itemid=5220649" alt="Lose Image">`);
        }

        // restart timer
        game.startTimer();
    },
    // advance to next round
    nextRound: function() {
        // declare that round is running, start count at 5
        round = true;
        count = 5;

        // display timer and question
        $('#content').empty();
        $('#content').append(`<div id='game-timer' class='display-2'>00:0${count}`); // display 3 second timer
        $('#content').append(`<div id='question'>${JSON.stringify(game.array[questionNum].question)}`); //2

        // define and loop through array of questions
        triviaQuestion = Object.values(game.array[questionNum])[1];
        triviaAnswer = Object.values(game.array[questionNum])[2];
        triviaIMG = Object.values(game.array[questionNum])[3];
        console.log(`\n== Round: ${questionNum} ==`);

        for (var i = 0; i < triviaQuestion.length; i++) {
            console.log(`${triviaQuestion[i]}`);
            $('#content').append(`<button id='option-${i}' class='option btn btn-primary btn-lg' value="${triviaQuestion[i]}">${triviaQuestion[i]}`);
        }

        // when player presses an option button, check if answer is correct
        $('.option').on('click', game.check);

        if (questionNum === game.array.length) {
            console.log('GG');
            console.log(questionNum + '|' + game.array.length);
            clearInterval(clock);
            game.gameOver();
        } else {
            // increment to advance to next question; restart timer
            questionNum++;
            game.startTimer();
        }
    }, 
    timer: function() {
        // lose a count each turn
        console.log(count);
        count--;

        // if count reaches 0, stop the clock, and advance to proper page
        if (count === 0 && questionNum === game.array.length) {
            console.log('gameover');
            game.gameOver();
        } else if (count === 0 && round === true) {
            isCorrect = false;
            console.log(round);
            incorrect++;
            console.log(`Times up | isCorrect: ${isCorrect} | Incorrect: ${incorrect}`);
            clearInterval(clock);
            game.nextPage();
        } else if (count === 0 && round === false) {
            isCorrect = false;
            console.log(round);
            console.log(`Times up | isCorrect: ${isCorrect} | Incorrect: ${incorrect}`);
            clearInterval(clock); //1
            game.nextRound();
        }

        // display time
        $('#game-timer').text(`00:0${count}`);
    },
    // starts a 1 sec interval
    startTimer: function() {
        clock = setInterval(game.timer, 1000); // for every second, run timer
    },
    // start game; define variables
    play: function() {
        questionNum = 0;
        round = false;
        isCorrect = false;
        correct = 0;
        incorrect = 0;
        $('#start').hide();
        game.nextRound();
    }
};

// when user presses start, play game
$(document).ready(function() {
    $('#start').on('click', game.play);
});
</script>
</body>
</html>